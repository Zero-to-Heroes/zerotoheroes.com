<div class="background-white video-upload" nv-file-drop uploader="uploader">

	<h1>{{ 'global.upload.video.headline' | translate }}</h1>

	<!-- The controls to add a file -->
	<div class="button-container">
		<span class="btn btn-default btn-file" ng-show="!file">
			<span>{{ 'global.upload.video.chooseFileButton' | translate }}</span> 
			<input type="file" name="file" class="upload-file-button" nv-file-select uploader="uploader" file analytics-on="click" analytics-category="upload" analytics-event="upload.chooseFile"></input>
		</span>
		<span class="btn btn-default btn-file" ng-show="file" ng-click="clearFile()">
			{{ 'global.upload.video.clearCurrentFile' | translate }}
		</span>
	</div>
	<div class="well drop-zone" nv-file-over uploader="uploader" ng-show="!file">
		{{ 'global.upload.video.dropZone' | translate }}
	</div>

	<!-- The error message if an invalid file format is added. We can't show it during the drag and drop, because we don't know what's the file type being dragged -->
	<div class="alert alert-danger unsupported-file-alert" role="alert" ng-show="hasUnsupportedFormatError">
		<span>{{ 'global.upload.video.invalidFormatMessage' | translate }}</span>
	</div>

	<!-- The video player. At this stage we just want to prepare the file for upload, so we're only concerned with the raw video editing tools -->
	<div class="videogular-container" ng-show="file">
		<videogular vg-player-ready="onPlayerReady($API)" class="videogular" vg-change-source="onSourceChanged($source)" class="videogular">
			<vg-media vg-src="sources"></vg-media>

			<vg-controls>
				<vg-play-pause-button></vg-play-pause-button>
				<vg-time-display>{{ currentTime | date:'mm:ss:sss' }}</vg-time-display>
				<vg-scrub-bar id="scrubBar" video-fine-time-control>
					<vg-scrub-bar-buffer></vg-scrub-bar-buffer>
					<vg-scrub-bar-current-time></vg-scrub-bar-current-time>
				</vg-scrub-bar>
				<vg-time-display>{{ totalTime | date:'mm:ss' }}</vg-time-display>
				<video-playback-button></video-playback-button>
				<vg-volume>
					<vg-mute-button></vg-mute-button>
					<vg-volume-bar></vg-volume-bar>
				</vg-volume>
			</vg-controls>

			<vg-overlay-play ng-click="onOverlayClick()"></vg-overlay-play>
		</videogular>
	</div>

	<div class="row" ng-show="file">
		<span class="slider-text">{{ 'global.upload.video.sliderLabel' | translate }}</span>
		<div range-slider min="0" max="sliderMax" model-min="min" model-max="max" attach-handle-values="true" filter="timeFilter" getter-setter="true" ng-show="videoInfo.ending > 0" show-values="true"></div>
	</div>
	<div class="row" ng-show="file && sportsConfig[sport.toLowerCase()].allowDoubleSpeed">
		<span class="double-speed-text">{{ 'global.upload.video.doubleSpeedLabel' | translate }}</span>
		<span class="block double-speed-link" ng-show="videoInfo.videoFramerateRatio && videoInfo.videoFramerateRatio == 1">
			<a ng-click="videoInfo.videoFramerateRatio = 2; maximumAllowedDuration = maximumAllowedDuration * videoInfo.videoFramerateRatio">{{ 'global.upload.video.doubleSpeedLink' | translate }}<span class="ion-help-circled pointer" aria-hidden="true" title="{{ 'global.upload.video.doubleSpeedExplanation' | translate }}" data-trigger="click" bs-tooltip></span></a>
		</span>
		<span class="block double-speed-link" ng-show="!videoInfo.videoFramerateRatio || videoInfo.videoFramerateRatio != 1">
			<a ng-click="maximumAllowedDuration = maximumAllowedDuration / videoInfo.videoFramerateRatio; videoInfo.videoFramerateRatio = 1">{{ 'global.upload.video.normalSpeedLink' | translate }}<span class="ion-help-circled pointer" aria-hidden="true" title="{{ 'global.upload.video.restoreSpeedExplanation' | translate }}" data-trigger="click" bs-tooltip></span></a>
		</span>
	</div>

	<!-- The messages that appear if the video is too long -->
	<div class="alert alert-danger video-time-limit" role="alert" ng-show="(clipDuration / 1000) > maximumAllowedDuration && !sportsConfig[sport.toLowerCase()].allowDoubleSpeed">
		<span>{{ 'global.upload.video.videoTooLong1' | translate }} <span class="ion-help-circled pointer" aria-hidden="true" title="{{ 'global.upload.video.whyLimit' | translate }}" data-trigger="click" bs-tooltip></span></span>
	</div>
	<div class="alert alert-danger video-time-limit" role="alert" ng-show="(clipDuration / 1000) > maximumAllowedDuration && sportsConfig[sport.toLowerCase()].allowDoubleSpeed">
		<span>{{ 'global.upload.video.videoTooLong2' | translate }} <span class="ion-help-circled pointer" aria-hidden="true" title="{{ 'global.upload.video.whyLimit' | translate }}" data-trigger="click" bs-tooltip></span></span>
	</div>

	<!-- Let's go! -->
	<div class="upload-button">
		<button type="submit" class="btn btn-primary btn-upload" ng-click="initUpload()" ng-disabled="hasUnsupportedFormatError || !file || (clipDuration / 1000) > maximumAllowedDuration" analytics-on="click" analytics-category="upload.video" analytics-event="upload.video.request"><span>{{ 'global.upload.uploadButton' | translate }}</span></button>
	</div>

</div>